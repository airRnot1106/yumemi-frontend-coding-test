import{j as A}from"./jsx-runtime-DoEZbXM1.js";import{r as Ve}from"./index-Za3YRiuF.js";import{r as L}from"./index-SP2qOBwU.js";import{a as Oe,c as X}from"./cx-CjKSjrk3.js";import{B as Ne}from"./button-DHkYrrPp.js";import"./button-C3-eB2TV.js";import{C as Ie}from"./checkbox-CHBJi7EY.js";const lt=[{prefCode:1,prefName:"北海道"},{prefCode:2,prefName:"青森県"},{prefCode:3,prefName:"岩手県"},{prefCode:4,prefName:"宮城県"},{prefCode:5,prefName:"秋田県"},{prefCode:6,prefName:"山形県"},{prefCode:7,prefName:"福島県"},{prefCode:8,prefName:"茨城県"},{prefCode:9,prefName:"栃木県"},{prefCode:10,prefName:"群馬県"},{prefCode:11,prefName:"埼玉県"},{prefCode:12,prefName:"千葉県"},{prefCode:13,prefName:"東京都"},{prefCode:14,prefName:"神奈川県"},{prefCode:15,prefName:"新潟県"},{prefCode:16,prefName:"富山県"},{prefCode:17,prefName:"石川県"},{prefCode:18,prefName:"福井県"},{prefCode:19,prefName:"山梨県"},{prefCode:20,prefName:"長野県"},{prefCode:21,prefName:"岐阜県"},{prefCode:22,prefName:"静岡県"},{prefCode:23,prefName:"愛知県"},{prefCode:24,prefName:"三重県"},{prefCode:25,prefName:"滋賀県"},{prefCode:26,prefName:"京都府"},{prefCode:27,prefName:"大阪府"},{prefCode:28,prefName:"兵庫県"},{prefCode:29,prefName:"奈良県"},{prefCode:30,prefName:"和歌山県"},{prefCode:31,prefName:"鳥取県"},{prefCode:32,prefName:"島根県"},{prefCode:33,prefName:"岡山県"},{prefCode:34,prefName:"広島県"},{prefCode:35,prefName:"山口県"},{prefCode:36,prefName:"徳島県"},{prefCode:37,prefName:"香川県"},{prefCode:38,prefName:"愛媛県"},{prefCode:39,prefName:"高知県"},{prefCode:40,prefName:"福岡県"},{prefCode:41,prefName:"佐賀県"},{prefCode:42,prefName:"長崎県"},{prefCode:43,prefName:"熊本県"},{prefCode:44,prefName:"大分県"},{prefCode:45,prefName:"宮崎県"},{prefCode:46,prefName:"鹿児島県"},{prefCode:47,prefName:"沖縄県"}],I=new WeakMap,U=new WeakMap,G={current:[]};let Y=!1,P=0;const T=new Set,B=new Map;function Fe(s){const a=Array.from(s).sort((t,e)=>t instanceof N&&t.options.deps.includes(e)?1:e instanceof N&&e.options.deps.includes(t)?-1:0);for(const t of a){if(G.current.includes(t))continue;G.current.push(t),t.recompute();const e=U.get(t);if(e)for(const r of e){const i=I.get(r);i&&Fe(i)}}}function De(s){s.listeners.forEach(a=>a({prevVal:s.prevState,currentVal:s.state}))}function ke(s){s.listeners.forEach(a=>a({prevVal:s.prevState,currentVal:s.state}))}function we(s){if(P>0&&!B.has(s)&&B.set(s,s.prevState),T.add(s),!(P>0)&&!Y)try{for(Y=!0;T.size>0;){const a=Array.from(T);T.clear();for(const t of a){const e=B.get(t)??t.prevState;t.prevState=e,De(t)}for(const t of a){const e=I.get(t);e&&(G.current.push(t),Fe(e))}for(const t of a){const e=I.get(t);if(e)for(const r of e)ke(r)}}}finally{Y=!1,G.current=[],B.clear()}}function O(s){P++;try{s()}finally{if(P--,P===0){const a=Array.from(T)[0];a&&we(a)}}}class ne{constructor(a,t){this.listeners=new Set,this.subscribe=e=>{var r,i;this.listeners.add(e);const n=(i=(r=this.options)==null?void 0:r.onSubscribe)==null?void 0:i.call(r,e,this);return()=>{this.listeners.delete(e),n==null||n()}},this.setState=e=>{var r,i,n;this.prevState=this.state,this.state=(r=this.options)!=null&&r.updateFn?this.options.updateFn(this.prevState)(e):e(this.prevState),(n=(i=this.options)==null?void 0:i.onUpdate)==null||n.call(i),we(this)},this.prevState=a,this.state=a,this.options=t}}class N{constructor(a){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const t=[],e=[];for(const r of this.options.deps)t.push(r.prevState),e.push(r.state);return this.lastSeenDepValues=e,{prevDepVals:t,currDepVals:e,prevVal:this.prevState??void 0}},this.recompute=()=>{var t,e;this.prevState=this.state;const{prevDepVals:r,currDepVals:i,prevVal:n}=this.getDepVals();this.state=this.options.fn({prevDepVals:r,currDepVals:i,prevVal:n}),(e=(t=this.options).onUpdate)==null||e.call(t)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof N&&i.checkIfRecalculationNeededDeeply();let t=!1;const e=this.lastSeenDepValues,{currDepVals:r}=this.getDepVals();for(let i=0;i<r.length;i++)if(r[i]!==e[i]){t=!0;break}t&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const t of this._subscriptions)t()}),this.subscribe=t=>{var e,r;this.listeners.add(t);const i=(r=(e=this.options).onSubscribe)==null?void 0:r.call(e,t,this);return()=>{this.listeners.delete(t),i==null||i()}},this.options=a,this.state=a.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(a=this.options.deps){for(const t of a)if(t instanceof N)t.registerOnGraph(),this.registerOnGraph(t.options.deps);else if(t instanceof ne){let e=I.get(t);e||(e=new Set,I.set(t,e)),e.add(this);let r=U.get(this);r||(r=new Set,U.set(this,r)),r.add(t)}}unregisterFromGraph(a=this.options.deps){for(const t of a)if(t instanceof N)this.unregisterFromGraph(t.options.deps);else if(t instanceof ne){const e=I.get(t);e&&e.delete(this);const r=U.get(this);r&&r.delete(t)}}}function K(s,a){return typeof s=="function"?s(a):s}function Ee(s,a){return de(a).reduce((e,r)=>{if(e===null)return null;if(typeof e<"u")return e[r]},s)}function Z(s,a,t){const e=de(a);function r(i){if(!e.length)return K(t,i);const n=e.shift();if(typeof n=="string"||typeof n=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[n]:r(i[n])}):{[n]:r()};if(Array.isArray(i)&&typeof n=="number"){const l=i.slice(0,n);return[...l.length?l:new Array(n),r(i[n]),...i.slice(n+1)]}return[...new Array(n),r()]}return r(s)}function Te(s,a){const t=de(a);function e(r){if(!r)return;if(t.length===1){const n=t[0];if(Array.isArray(r)&&typeof n=="number")return r.filter((d,c)=>c!==n);const{[n]:l,...f}=r;return f}const i=t.shift();if(typeof i=="string"&&typeof r=="object")return{...r,[i]:e(r[i])};if(typeof i=="number"&&Array.isArray(r)){if(i>=r.length)return r;const n=r.slice(0,i);return[...n.length?n:new Array(i),e(r[i]),...r.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return e(s)}const Pe=/^(\d*)$/gm,Le=/\.(\d*)\./gm,$e=/^(\d*)\./gm,Be=/\.(\d*$)/gm,je=/\.{2,}/gm,oe="__int__",j=`${oe}$1`;function de(s){if(Array.isArray(s))return[...s];if(typeof s!="string")throw new Error("Path must be a string.");return s.replace(/\[/g,".").replace(/\]/g,"").replace(Pe,j).replace(Le,`.${j}.`).replace($e,`${j}.`).replace(Be,`.${j}`).replace(je,".").split(".").map(a=>a.indexOf(oe)===0?parseInt(a.substring(oe.length),10):a)}function We(s){return!(Array.isArray(s)&&s.length===0)}function le(s,a){const{asyncDebounceMs:t}=a,{onChangeAsync:e,onBlurAsync:r,onSubmitAsync:i,onBlurAsyncDebounceMs:n,onChangeAsyncDebounceMs:l}=a.validators||{},f=t??0,d={cause:"change",validate:e,debounceMs:l??f},c={cause:"blur",validate:r,debounceMs:n??f},u={cause:"submit",validate:i,debounceMs:0},o=h=>({...h,debounceMs:0});switch(s){case"submit":return[o(d),o(c),u];case"blur":return[c];case"change":return[d];case"server":default:return[]}}function ue(s,a){const{onChange:t,onBlur:e,onSubmit:r,onMount:i}=a.validators||{},n={cause:"change",validate:t},l={cause:"blur",validate:e},f={cause:"submit",validate:r},d={cause:"mount",validate:i},c={cause:"server",validate:()=>{}};switch(s){case"mount":return[d];case"submit":return[n,l,f,c];case"server":return[c];case"blur":return[l,c];case"change":default:return[n,c]}}const _e=s=>!!s&&typeof s=="object"&&"fields"in s;function ee(s,a){if(Object.is(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;if(s instanceof Map&&a instanceof Map){if(s.size!==a.size)return!1;for(const[e,r]of s)if(!a.has(e)||!Object.is(r,a.get(e)))return!1;return!0}if(s instanceof Set&&a instanceof Set){if(s.size!==a.size)return!1;for(const e of s)if(!a.has(e))return!1;return!0}const t=Object.keys(s);if(t.length!==Object.keys(a).length)return!1;for(let e=0;e<t.length;e++)if(!Object.prototype.hasOwnProperty.call(a,t[e])||!Object.is(s[t[e]],a[t[e]]))return!1;return!0}const me=({newFormValidatorError:s,isPreviousErrorFromFormValidator:a,previousErrorValue:t})=>s?{newErrorValue:s,newSource:"form"}:a?{newErrorValue:void 0,newSource:void 0}:t?{newErrorValue:t,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},pe=({formLevelError:s,fieldLevelError:a})=>a?{newErrorValue:a,newSource:"field"}:s?{newErrorValue:s,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function ze(s){const a=new Map;for(const t of s){const e=[...t.path??[]].map(r=>{const i=typeof r=="object"?r.key:r;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");a.set(e,(a.get(e)??[]).concat(t))}return Object.fromEntries(a)}const ve=s=>{const a=ze(s);return{form:a,fields:a}},D={validate({value:s,validationSource:a},t){const e=t["~standard"].validate(s);if(e instanceof Promise)throw new Error("async function passed to sync validator");if(e.issues)return a==="field"?e.issues:ve(e.issues)},async validateAsync({value:s,validationSource:a},t){const e=await t["~standard"].validate(s);if(e.issues)return a==="field"?e.issues:ve(e.issues)}},Ce=s=>!!s&&"~standard"in s,x={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,errors:[],errorMap:{},errorSourceMap:{}};function W(s){function a(u,o,h,m){const p=e(u,o,h,m);({insert:()=>l(p,u,o),remove:()=>f(p),swap:()=>m!==void 0&&c(p,u,o,m),move:()=>m!==void 0&&d(p,u,o,m)})[h]()}function t(u,o){return`${u}[${o}]`}function e(u,o,h,m){const p=[t(u,o)];if(h==="swap")p.push(t(u,m));else if(h==="move"){const[v,M]=[Math.min(o,m),Math.max(o,m)];for(let g=v;g<=M;g++)p.push(t(u,g))}else{const v=s.getFieldValue(u),M=Array.isArray(v)?v.length:0;for(let g=o+1;g<M;g++)p.push(t(u,g))}return Object.keys(s.fieldInfo).filter(v=>p.some(M=>v.startsWith(M)))}function r(u,o){return u.replace(/\[(\d+)\]/,(h,m)=>{const p=parseInt(m,10);return`[${o==="up"?p+1:Math.max(0,p-1)}]`})}function i(u,o){(o==="up"?u:[...u].reverse()).forEach(m=>{const p=r(m.toString(),o),v=s.getFieldMeta(p);v?s.setFieldMeta(m,v):s.setFieldMeta(m,n())})}const n=()=>x,l=(u,o,h)=>{i(u,"down"),u.forEach(m=>{m.toString().startsWith(t(o,h))&&s.setFieldMeta(m,n())})},f=u=>{i(u,"up")},d=(u,o,h,m)=>{const p=new Map(Object.keys(s.fieldInfo).filter(v=>v.startsWith(t(o,h))).map(v=>[v,s.getFieldMeta(v)]));i(u,h<m?"up":"down"),Object.keys(s.fieldInfo).filter(v=>v.startsWith(t(o,m))).forEach(v=>{const M=v.replace(t(o,m),t(o,h)),g=p.get(M);g&&s.setFieldMeta(v,g)})},c=(u,o,h,m)=>{u.forEach(p=>{if(!p.toString().startsWith(t(o,h)))return;const v=p.toString().replace(t(o,h),t(o,m)),[M,g]=[s.getFieldMeta(p),s.getFieldMeta(v)];M&&s.setFieldMeta(v,M),g&&s.setFieldMeta(p,g)})};return{handleArrayFieldMetaShift:a}}function te(s){return{values:s.values??{},errorMap:s.errorMap??{},fieldMetaBase:s.fieldMetaBase??{},isSubmitted:s.isSubmitted??!1,isSubmitting:s.isSubmitting??!1,isValidating:s.isValidating??!1,submissionAttempts:s.submissionAttempts??0,isSubmitSuccessful:s.isSubmitSuccessful??!1,validationMetaMap:s.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class Re{constructor(a){var t;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var e,r;const i=this.fieldMetaDerived.mount(),n=this.store.mount(),l=()=>{i(),n()};(r=(e=this.options.listeners)==null?void 0:e.onMount)==null||r.call(e,{formApi:this});const{onMount:f}=this.options.validators||{};return f&&this.validateSync("mount"),l},this.update=e=>{var r,i;if(!e)return;const n=this.options;this.options=e;const l=!!((i=(r=e.transform)==null?void 0:r.deps)!=null&&i.some((c,u)=>c!==this.prevTransformArray[u])),f=e.defaultValues&&!ee(e.defaultValues,n.defaultValues)&&!this.state.isTouched,d=!ee(e.defaultState,n.defaultState)&&!this.state.isTouched;!f&&!d&&!l||O(()=>{this.baseStore.setState(()=>te(Object.assign({},this.state,d?e.defaultState:{},f?{values:e.defaultValues}:{},l?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(e,r)=>{const{fieldMeta:i}=this.state,n=this.resetFieldMeta(i);e&&!(r!=null&&r.keepDefaultValues)&&(this.options={...this.options,defaultValues:e}),this.baseStore.setState(()=>{var l;return te({...this.options.defaultState,values:e??this.options.defaultValues??((l=this.options.defaultState)==null?void 0:l.values),fieldMetaBase:n})})},this.validateAllFields=async e=>{const r=[];return O(()=>{Object.values(this.fieldInfo).forEach(n=>{if(!n.instance)return;const l=n.instance;r.push(Promise.resolve().then(()=>l.validate(e,{skipFormValidation:!0}))),n.instance.state.meta.isTouched||n.instance.setMeta(f=>({...f,isTouched:!0}))})}),(await Promise.all(r)).flat()},this.validateArrayFieldsStartingFrom=async(e,r,i)=>{const n=this.getFieldValue(e),l=Array.isArray(n)?Math.max(n.length-1,0):null,f=[`${e}[${r}]`];for(let o=r+1;o<=(l??0);o++)f.push(`${e}[${o}]`);const d=Object.keys(this.fieldInfo).filter(o=>f.some(h=>o.startsWith(h))),c=[];return O(()=>{d.forEach(o=>{c.push(Promise.resolve().then(()=>this.validateField(o,i)))})}),(await Promise.all(c)).flat()},this.validateField=(e,r)=>{var i;const n=(i=this.fieldInfo[e])==null?void 0:i.instance;return n?(n.state.meta.isTouched||n.setMeta(l=>({...l,isTouched:!0})),n.validate(r)):[]},this.validateSync=e=>{const r=ue(e,this.options);let i=!1;const n={};return O(()=>{var l,f;for(const c of r){if(!c.validate)continue;const u=this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:o,fieldErrors:h}=ce(u),m=z(c.cause);for(const p of Object.keys(this.state.fieldMeta)){const v=this.getFieldMeta(p);if(!v)continue;const{errorMap:M,errorSourceMap:g}=v,y=h==null?void 0:h[p],{newErrorValue:b,newSource:E}=me({newFormValidatorError:y,isPreviousErrorFromFormValidator:(g==null?void 0:g[m])==="form",previousErrorValue:M==null?void 0:M[m]});E==="form"&&(n[p]={...n[p],[m]:y}),(M==null?void 0:M[m])!==b&&this.setFieldMeta(p,V=>({...V,errorMap:{...V.errorMap,[m]:b},errorSourceMap:{...V.errorSourceMap,[m]:E}}))}((l=this.state.errorMap)==null?void 0:l[m])!==o&&this.baseStore.setState(p=>({...p,errorMap:{...p.errorMap,[m]:o}})),(o||h)&&(i=!0)}const d=z("submit");(f=this.state.errorMap)!=null&&f[d]&&e!=="submit"&&!i&&this.baseStore.setState(c=>({...c,errorMap:{...c.errorMap,[d]:void 0}}))}),{hasErrored:i,fieldsErrorMap:n}},this.validateAsync=async e=>{const r=le(e,this.options);this.state.isFormValidating||this.baseStore.setState(d=>({...d,isFormValidating:!0}));const i=[];let n;for(const d of r){if(!d.validate)continue;const c=z(d.cause),u=this.state.validationMetaMap[c];u==null||u.lastAbortController.abort();const o=new AbortController;this.state.validationMetaMap[c]={lastAbortController:o},i.push(new Promise(async h=>{let m;try{m=await new Promise((g,y)=>{setTimeout(async()=>{if(o.signal.aborted)return g(void 0);try{g(await this.runValidator({validate:d.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:o.signal},type:"validateAsync"}))}catch(b){y(b)}},d.debounceMs)})}catch(g){m=g}const{formError:p,fieldErrors:v}=ce(m);v&&(n=n?{...n,...v}:v);const M=z(d.cause);for(const g of Object.keys(this.state.fieldMeta)){const y=this.getFieldMeta(g);if(!y)continue;const{errorMap:b,errorSourceMap:E}=y,V=n==null?void 0:n[g],{newErrorValue:w,newSource:_}=me({newFormValidatorError:V,isPreviousErrorFromFormValidator:(E==null?void 0:E[M])==="form",previousErrorValue:b==null?void 0:b[M]});(b==null?void 0:b[M])!==w&&this.setFieldMeta(g,F=>({...F,errorMap:{...F.errorMap,[M]:w},errorSourceMap:{...F.errorSourceMap,[M]:_}}))}this.baseStore.setState(g=>({...g,errorMap:{...g.errorMap,[M]:p}})),h(n?{fieldErrors:n,errorMapKey:M}:void 0)}))}let l=[];const f={};if(i.length){l=await Promise.all(i);for(const d of l)if(d!=null&&d.fieldErrors){const{errorMapKey:c}=d;for(const[u,o]of Object.entries(d.fieldErrors)){const m={...f[u]||{},[c]:o};f[u]=m}}}return this.baseStore.setState(d=>({...d,isFormValidating:!1})),f},this.validate=e=>{const{hasErrored:r,fieldsErrorMap:i}=this.validateSync(e);return r&&!this.options.asyncAlways?i:this.validateAsync(e)},this.getFieldValue=e=>Ee(this.state.values,e),this.getFieldMeta=e=>this.state.fieldMeta[e],this.getFieldInfo=e=>{var r;return(r=this.fieldInfo)[e]||(r[e]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(e,r)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[e]:K(r,i.fieldMetaBase[e])}}))},this.resetFieldMeta=e=>Object.keys(e).reduce((r,i)=>{const n=i;return r[n]=x,r},{}),this.setFieldValue=(e,r,i)=>{const n=(i==null?void 0:i.dontUpdateMeta)??!1;O(()=>{n||this.setFieldMeta(e,l=>({...l,isTouched:!0,isDirty:!0,errorMap:{...l==null?void 0:l.errorMap,onMount:void 0}})),this.baseStore.setState(l=>({...l,values:Z(l.values,e,r)}))})},this.deleteField=e=>{const i=[...Object.keys(this.fieldInfo).filter(n=>{const l=e.toString();return n!==l&&n.startsWith(l)}),e];this.baseStore.setState(n=>{const l={...n};return i.forEach(f=>{l.values=Te(l.values,f),delete this.fieldInfo[f],delete l.fieldMetaBase[f]}),l})},this.pushFieldValue=(e,r,i)=>{this.setFieldValue(e,n=>[...Array.isArray(n)?n:[],r],i),this.validateField(e,"change")},this.insertFieldValue=async(e,r,i,n)=>{this.setFieldValue(e,l=>[...l.slice(0,r),i,...l.slice(r)],n),await this.validateField(e,"change"),W(this).handleArrayFieldMetaShift(e,r,"insert"),await this.validateArrayFieldsStartingFrom(e,r,"change")},this.replaceFieldValue=async(e,r,i,n)=>{this.setFieldValue(e,l=>l.map((f,d)=>d===r?i:f),n),await this.validateField(e,"change"),await this.validateArrayFieldsStartingFrom(e,r,"change")},this.removeFieldValue=async(e,r,i)=>{const n=this.getFieldValue(e),l=Array.isArray(n)?Math.max(n.length-1,0):null;if(this.setFieldValue(e,f=>f.filter((d,c)=>c!==r),i),W(this).handleArrayFieldMetaShift(e,r,"remove"),l!==null){const f=`${e}[${l}]`;this.deleteField(f)}await this.validateField(e,"change"),await this.validateArrayFieldsStartingFrom(e,r,"change")},this.swapFieldValues=(e,r,i,n)=>{this.setFieldValue(e,l=>{const f=l[r],d=l[i];return Z(Z(l,`${r}`,d),`${i}`,f)},n),W(this).handleArrayFieldMetaShift(e,r,"swap",i),this.validateField(e,"change"),this.validateField(`${e}[${r}]`,"change"),this.validateField(`${e}[${i}]`,"change")},this.moveFieldValues=(e,r,i,n)=>{this.setFieldValue(e,l=>(l.splice(i,0,l.splice(r,1)[0]),l),n),W(this).handleArrayFieldMetaShift(e,r,"move",i),this.validateField(e,"change"),this.validateField(`${e}[${r}]`,"change"),this.validateField(`${e}[${i}]`,"change")},this.resetField=e=>{this.baseStore.setState(r=>({...r,fieldMetaBase:{...r.fieldMetaBase,[e]:x},values:{...r.values,[e]:this.options.defaultValues&&this.options.defaultValues[e]}}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((e,[r,i])=>(Object.keys(i).length&&i.errors.length&&(e[r]={errors:i.errors,errorMap:i.errorMap}),e),{})}),this.parseValuesWithSchema=e=>D.validate({value:this.state.values,validationSource:"form"},e),this.parseValuesWithSchemaAsync=e=>D.validateAsync({value:this.state.values,validationSource:"form"},e),this.baseStore=new ne(te({...a==null?void 0:a.defaultState,values:(a==null?void 0:a.defaultValues)??((t=a==null?void 0:a.defaultState)==null?void 0:t.values)})),this.fieldMetaDerived=new N({deps:[this.baseStore],fn:({prevDepVals:e,currDepVals:r,prevVal:i})=>{var n;const l=i,f=e==null?void 0:e[0],d=r[0];let c=0;const u={};for(const o of Object.keys(d.fieldMetaBase)){const h=d.fieldMetaBase[o],m=f==null?void 0:f.fieldMetaBase[o],p=l==null?void 0:l[o];let v=p==null?void 0:p.errors;if(!m||h.errorMap!==m.errorMap){v=Object.values(h.errorMap??{}).filter(b=>b!==void 0);const y=(n=this.getFieldInfo(o))==null?void 0:n.instance;y&&!y.options.disableErrorFlat&&(v=v==null?void 0:v.flat(1))}const M=!h.isDirty,g=!We(v??[]);if(p&&p.isPristine===M&&p.isValid===g&&p.errors===v&&h===m){u[o]=p,c++;continue}u[o]={...h,errors:v,isPristine:M,isValid:g}}return Object.keys(d.fieldMetaBase).length&&l&&c===Object.keys(d.fieldMetaBase).length?l:u}}),this.store=new N({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:e,currDepVals:r,prevVal:i})=>{var n,l,f,d;const c=i,u=e==null?void 0:e[0],o=r[0],h=r[1],m=Object.values(h).filter(Boolean),p=m.some(S=>S.isValidating),v=m.every(S=>S.isValid),M=m.some(S=>S.isTouched),g=m.some(S=>S.isBlurred),y=M&&((n=o.errorMap)==null?void 0:n.onMount),b=m.some(S=>S.isDirty),E=!b,V=!!((l=o.errorMap)!=null&&l.onMount||m.some(S=>{var C;return(C=S==null?void 0:S.errorMap)==null?void 0:C.onMount})),w=!!p;let _=(c==null?void 0:c.errors)??[];(!u||o.errorMap!==u.errorMap)&&(_=Object.values(o.errorMap).reduce((S,C)=>C===void 0?S:C&&_e(C)?(S.push(C.form),S):(S.push(C),S),[]));const F=_.length===0,k=v&&F,H=this.options.canSubmitWhenInvalid??!1,he=o.submissionAttempts===0&&!M&&!V||!w&&!o.isSubmitting&&k||H;let $=o.errorMap;if(y&&(_=_.filter(S=>S!==o.errorMap.onMount),$=Object.assign($,{onMount:void 0})),c&&u&&c.errorMap===$&&c.fieldMeta===this.fieldMetaDerived.state&&c.errors===_&&c.isFieldsValidating===p&&c.isFieldsValid===v&&c.isFormValid===F&&c.isValid===k&&c.canSubmit===he&&c.isTouched===M&&c.isBlurred===g&&c.isPristine===E&&c.isDirty===b&&ee(u,o))return c;let J={...o,errorMap:$,fieldMeta:this.fieldMetaDerived.state,errors:_,isFieldsValidating:p,isFieldsValid:v,isFormValid:F,isValid:k,canSubmit:he,isTouched:M,isBlurred:g,isPristine:E,isDirty:b};const Q=((f=this.options.transform)==null?void 0:f.deps)??[];if(Q.length!==this.prevTransformArray.length||Q.some((S,C)=>S!==this.prevTransformArray[C])){const S=Object.assign({},this,{state:J});(d=this.options.transform)==null||d.fn(S),J=S.state,this.prevTransformArray=Q}return J}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(a||{})}get state(){return this.store.state}runValidator(a){return Ce(a.validate)?D[a.type](a.value,a.validate):a.validate(a.value)}async handleSubmit(a){var t,e,r,i,n,l,f,d;if(this.baseStore.setState(u=>({...u,isSubmitted:!1,submissionAttempts:u.submissionAttempts+1,isSubmitSuccessful:!1})),O(()=>{Object.values(this.fieldInfo).forEach(u=>{u.instance&&(u.instance.state.meta.isTouched||u.instance.setMeta(o=>({...o,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(u=>({...u,isSubmitting:!0}));const c=()=>{this.baseStore.setState(u=>({...u,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){c(),(e=(t=this.options).onSubmitInvalid)==null||e.call(t,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){c(),(i=(r=this.options).onSubmitInvalid)==null||i.call(r,{value:this.state.values,formApi:this});return}O(()=>{Object.values(this.fieldInfo).forEach(u=>{var o,h,m;(m=(h=(o=u.instance)==null?void 0:o.options.listeners)==null?void 0:h.onSubmit)==null||m.call(h,{value:u.instance.state.value,fieldApi:u.instance})})}),(l=(n=this.options.listeners)==null?void 0:n.onSubmit)==null||l.call(n,{formApi:this});try{await((d=(f=this.options).onSubmit)==null?void 0:d.call(f,{value:this.state.values,formApi:this,meta:a??this.options.onSubmitMeta})),O(()=>{this.baseStore.setState(u=>({...u,isSubmitted:!0,isSubmitSuccessful:!0})),c()})}catch(u){throw this.baseStore.setState(o=>({...o,isSubmitSuccessful:!1})),c(),u}}setErrorMap(a){this.baseStore.setState(t=>({...t,errorMap:{...t.errorMap,...a}}))}}function ce(s){if(s){if(_e(s)){const a=ce(s.form).formError,t=s.fields;return{formError:a,fieldErrors:t}}return{formError:s}}return{formError:void 0}}function z(s){switch(s){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class Ue{constructor(a){this.options={},this.mount=()=>{var t,e;const r=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:n}=this.options.validators||{};if(n){const l=this.runValidator({validate:n,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});l&&this.setMeta(f=>({...f,errorMap:{...f==null?void 0:f.errorMap,onMount:l},errorSourceMap:{...f==null?void 0:f.errorSourceMap,onMount:"field"}}))}return(e=(t=this.options.listeners)==null?void 0:t.onMount)==null||e.call(t,{value:this.state.value,fieldApi:this}),r},this.update=t=>{this.options=t;const e=this.name!==t.name;if(this.name=t.name,this.state.value===void 0){const r=Ee(t.form.options.defaultValues,t.name),i=t.defaultValue??r;e?this.setValue(n=>n||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(t,e)=>{this.form.setFieldValue(this.name,t,e),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=t=>this.form.setFieldMeta(this.name,t),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(t,e)=>{this.form.pushFieldValue(this.name,t,e),this.triggerOnChangeListener()},this.insertValue=(t,e,r)=>{this.form.insertFieldValue(this.name,t,e,r),this.triggerOnChangeListener()},this.replaceValue=(t,e,r)=>{this.form.replaceFieldValue(this.name,t,e,r),this.triggerOnChangeListener()},this.removeValue=(t,e)=>{this.form.removeFieldValue(this.name,t,e),this.triggerOnChangeListener()},this.swapValues=(t,e,r)=>{this.form.swapFieldValues(this.name,t,e,r),this.triggerOnChangeListener()},this.moveValue=(t,e,r)=>{this.form.moveFieldValues(this.name,t,e,r),this.triggerOnChangeListener()},this.getLinkedFields=t=>{const e=Object.values(this.form.fieldInfo),r=[];for(const i of e){if(!i.instance)continue;const{onChangeListenTo:n,onBlurListenTo:l}=i.instance.options.validators||{};t==="change"&&(n!=null&&n.includes(this.name))&&r.push(i.instance),t==="blur"&&(l!=null&&l.includes(this.name))&&r.push(i.instance)}return r},this.validateSync=(t,e)=>{var r;const i=ue(t,this.options),l=this.getLinkedFields(t).reduce((c,u)=>{const o=ue(t,u.options);return o.forEach(h=>{h.field=u}),c.concat(o)},[]);let f=!1;O(()=>{const c=(u,o)=>{var h;const m=R(o.cause),p=o.validate?Me(u.runValidator({validate:o.validate,value:{value:u.store.state.value,validationSource:"field",fieldApi:u},type:"validate"})):void 0,v=e[m],{newErrorValue:M,newSource:g}=pe({formLevelError:v,fieldLevelError:p});((h=u.state.meta.errorMap)==null?void 0:h[m])!==M&&u.setMeta(y=>({...y,errorMap:{...y.errorMap,[m]:M},errorSourceMap:{...y.errorSourceMap,[m]:g}})),M&&(f=!0)};for(const u of i)c(this,u);for(const u of l)u.validate&&c(u.field,u)});const d=R("submit");return(r=this.state.meta.errorMap)!=null&&r[d]&&t!=="submit"&&!f&&this.setMeta(c=>({...c,errorMap:{...c.errorMap,[d]:void 0},errorSourceMap:{...c.errorSourceMap,[d]:void 0}})),{hasErrored:f}},this.validateAsync=async(t,e)=>{const r=le(t,this.options),i=await e,n=this.getLinkedFields(t),l=n.reduce((o,h)=>{const m=le(t,h.options);return m.forEach(p=>{p.field=h}),o.concat(m)},[]);this.state.meta.isValidating||this.setMeta(o=>({...o,isValidating:!0}));for(const o of n)o.setMeta(h=>({...h,isValidating:!0}));const f=[],d=[],c=(o,h,m)=>{const p=R(h.cause),v=o.getInfo().validationMetaMap[p];v==null||v.lastAbortController.abort();const M=new AbortController;this.getInfo().validationMetaMap[p]={lastAbortController:M},m.push(new Promise(async g=>{var y;let b;try{b=await new Promise((F,k)=>{this.timeoutIds.validations[h.cause]&&clearTimeout(this.timeoutIds.validations[h.cause]),this.timeoutIds.validations[h.cause]=setTimeout(async()=>{if(M.signal.aborted)return F(void 0);try{F(await this.runValidator({validate:h.validate,value:{value:o.store.state.value,fieldApi:o,signal:M.signal,validationSource:"field"},type:"validateAsync"}))}catch(H){k(H)}},h.debounceMs)})}catch(F){b=F}if(M.signal.aborted)return g(void 0);const E=Me(b),V=(y=i[this.name])==null?void 0:y[p],{newErrorValue:w,newSource:_}=pe({formLevelError:V,fieldLevelError:E});o.setMeta(F=>({...F,errorMap:{...F==null?void 0:F.errorMap,[p]:w},errorSourceMap:{...F.errorSourceMap,[p]:_}})),g(w)}))};for(const o of r)o.validate&&c(this,o,f);for(const o of l)o.validate&&c(o.field,o,d);let u=[];(f.length||d.length)&&(u=await Promise.all(f),await Promise.all(d)),this.setMeta(o=>({...o,isValidating:!1}));for(const o of n)o.setMeta(h=>({...h,isValidating:!1}));return u.filter(Boolean)},this.validate=(t,e)=>{var r;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=e!=null&&e.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(t),{hasErrored:n}=this.validateSync(t,i[this.name]??{});if(n&&!this.options.asyncAlways)return(r=this.getInfo().validationMetaMap[R(t)])==null||r.lastAbortController.abort(),this.state.meta.errors;const l=e!=null&&e.skipFormValidation?Promise.resolve({}):this.form.validateAsync(t);return this.validateAsync(t,l)},this.handleChange=t=>{this.setValue(t)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(e=>({...e,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(e=>({...e,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=t=>D.validate({value:this.state.value,validationSource:"field"},t),this.parseValueWithSchemaAsync=t=>D.validateAsync({value:this.state.value,validationSource:"field"},t),this.form=a.form,this.name=a.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new N({deps:[this.form.store],fn:()=>{const t=this.form.getFieldValue(this.name),e=this.form.getFieldMeta(this.name)??{...x,...a.defaultMeta};return{value:t,meta:e}}}),this.options=a}get state(){return this.store.state}runValidator(a){return Ce(a.validate)?D[a.type](a.value,a.validate):a.validate(a.value)}setErrorMap(a){this.setMeta(t=>({...t,errorMap:{...t.errorMap,...a}}))}triggerOnBlurListener(){var a,t,e,r,i,n;const l=(a=this.form.options.listeners)==null?void 0:a.onBlurDebounceMs;l&&l>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var d,c;(c=(d=this.form.options.listeners)==null?void 0:d.onBlur)==null||c.call(d,{formApi:this.form,fieldApi:this})},l)):(e=(t=this.form.options.listeners)==null?void 0:t.onBlur)==null||e.call(t,{formApi:this.form,fieldApi:this});const f=(r=this.options.listeners)==null?void 0:r.onBlurDebounceMs;f&&f>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var d,c;(c=(d=this.options.listeners)==null?void 0:d.onBlur)==null||c.call(d,{value:this.state.value,fieldApi:this})},f)):(n=(i=this.options.listeners)==null?void 0:i.onBlur)==null||n.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var a,t,e,r,i,n;const l=(a=this.form.options.listeners)==null?void 0:a.onChangeDebounceMs;l&&l>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var d,c;(c=(d=this.form.options.listeners)==null?void 0:d.onChange)==null||c.call(d,{formApi:this.form,fieldApi:this})},l)):(e=(t=this.form.options.listeners)==null?void 0:t.onChange)==null||e.call(t,{formApi:this.form,fieldApi:this});const f=(r=this.options.listeners)==null?void 0:r.onChangeDebounceMs;f&&f>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var d,c;(c=(d=this.options.listeners)==null?void 0:d.onChange)==null||c.call(d,{value:this.state.value,fieldApi:this})},f)):(n=(i=this.options.listeners)==null?void 0:i.onChange)==null||n.call(i,{value:this.state.value,fieldApi:this})}}function Me(s){if(s)return s}function R(s){switch(s){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var re={exports:{}},se={},ie={exports:{}},ae={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ge;function Ge(){if(ge)return ae;ge=1;var s=Ve();function a(u,o){return u===o&&(u!==0||1/u===1/o)||u!==u&&o!==o}var t=typeof Object.is=="function"?Object.is:a,e=s.useState,r=s.useEffect,i=s.useLayoutEffect,n=s.useDebugValue;function l(u,o){var h=o(),m=e({inst:{value:h,getSnapshot:o}}),p=m[0].inst,v=m[1];return i(function(){p.value=h,p.getSnapshot=o,f(p)&&v({inst:p})},[u,h,o]),r(function(){return f(p)&&v({inst:p}),u(function(){f(p)&&v({inst:p})})},[u]),n(h),h}function f(u){var o=u.getSnapshot;u=u.value;try{var h=o();return!t(u,h)}catch{return!0}}function d(u,o){return o()}var c=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return ae.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:c,ae}var Se;function xe(){return Se||(Se=1,ie.exports=Ge()),ie.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ye;function qe(){if(ye)return se;ye=1;var s=Ve(),a=xe();function t(d,c){return d===c&&(d!==0||1/d===1/c)||d!==d&&c!==c}var e=typeof Object.is=="function"?Object.is:t,r=a.useSyncExternalStore,i=s.useRef,n=s.useEffect,l=s.useMemo,f=s.useDebugValue;return se.useSyncExternalStoreWithSelector=function(d,c,u,o,h){var m=i(null);if(m.current===null){var p={hasValue:!1,value:null};m.current=p}else p=m.current;m=l(function(){function M(V){if(!g){if(g=!0,y=V,V=o(V),h!==void 0&&p.hasValue){var w=p.value;if(h(w,V))return b=w}return b=V}if(w=b,e(y,V))return w;var _=o(V);return h!==void 0&&h(w,_)?(y=V,w):(y=V,b=_)}var g=!1,y,b,E=u===void 0?null:u;return[function(){return M(c())},E===null?void 0:function(){return M(E())}]},[c,u,o,h]);var v=r(d,m[0],m[1]);return n(function(){p.hasValue=!0,p.value=v},[v]),f(v),v},se}var be;function Ke(){return be||(be=1,re.exports=qe()),re.exports}var He=Ke();function fe(s,a=t=>t){return He.useSyncExternalStoreWithSelector(s.subscribe,()=>s.state,()=>s.state,a,Je)}function Je(s,a){if(Object.is(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;if(s instanceof Map&&a instanceof Map){if(s.size!==a.size)return!1;for(const[e,r]of s)if(!a.has(e)||!Object.is(r,a.get(e)))return!1;return!0}if(s instanceof Set&&a instanceof Set){if(s.size!==a.size)return!1;for(const e of s)if(!a.has(e))return!1;return!0}const t=Object.keys(s);if(t.length!==Object.keys(a).length)return!1;for(let e=0;e<t.length;e++)if(!Object.prototype.hasOwnProperty.call(a,t[e])||!Object.is(s[t[e]],a[t[e]]))return!1;return!0}const q=typeof window<"u"?L.useLayoutEffect:L.useEffect;function Qe(s){const[a]=L.useState(()=>{const e=new Ue({...s,form:s.form,name:s.name});return e.Field=Ae,e});return q(a.mount,[a]),q(()=>{a.update(s)}),fe(a.store,s.mode==="array"?t=>[t.meta,Object.keys(t.value??[]).length]:void 0),a}const Ae=({children:s,...a})=>{const t=Qe(a),e=L.useMemo(()=>K(s,t),[s,t,t.state.value,t.state.meta]);return A.jsx(A.Fragment,{children:e})};function Xe({form:s,selector:a,children:t}){const e=fe(s.store,a);return K(t,e)}function Ye(s){const[a]=L.useState(()=>{const t=new Re(s),e=t;return e.Field=function(i){return A.jsx(Ae,{...i,form:t})},e.Subscribe=r=>A.jsx(Xe,{form:t,selector:r.selector,children:r.children}),e});return q(a.mount,[]),fe(a.store,t=>t.isSubmitting),q(()=>{a.update(s)}),a}const Ze=({defaultValues:s=[],prefectures:a,onSubmit:t,onReset:e,className:r,...i})=>{const n=Ye({defaultValues:{prefCodes:s},onSubmit:({value:l})=>{t(l.prefCodes)}});return A.jsxs("form",{className:Oe(r,X({display:"grid",gridAutoFlow:"row",rowGap:"2rem"})),...i,children:[A.jsx(n.Field,{children:l=>A.jsx("ul",{className:X({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(8rem, 1fr))",rowGap:"0.5rem"}),children:a.map(({prefCode:f,prefName:d})=>A.jsx("li",{children:A.jsx(Ie,{checked:l.state.value.includes(f),name:l.name,onBlur:l.handleBlur,onChange:c=>{const u=c.target.checked?[...l.state.value,f]:l.state.value.filter(o=>o!==f);u.sort((o,h)=>o-h),l.handleChange(u)},value:f,children:d})},f))}),listeners:{onChange:({value:l})=>{if(l.length===0){e();return}t(l)}},name:"prefCodes"}),A.jsx(Ne,{className:X({justifySelf:"center",width:"fit-content"}),onClick:l=>{l.preventDefault(),n.reset(),e()},type:"reset",variant:"normal",children:"リセット"})]})};Ze.__docgenInfo={description:"",methods:[],displayName:"PrefectureFormPresentational",props:{defaultValues:{required:!1,tsType:{name:"Array",elements:[{name:"z.infer['prefCode']",raw:"Prefecture['prefCode']"}],raw:"PrefCode[]"},description:"",defaultValue:{value:"[]",computed:!1}},prefectures:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"prefectureSchema"}],raw:"z.infer<typeof prefectureSchema>"}],raw:"Prefecture[]"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(prefCodes: PrefCode[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"z.infer['prefCode']",raw:"Prefecture['prefCode']"}],raw:"PrefCode[]"},name:"prefCodes"}],return:{name:"void"}}},description:""},onReset:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{Ze as P,lt as p};
